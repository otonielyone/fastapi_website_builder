{% extends "template.html" %}

{% block head %}
<link rel="stylesheet" href="/static/main.css">
<link rel="stylesheet" href="/static/rentals.css">
{% endblock %}

{% block header %}
{% endblock %}

{% block body %}
<div class="rentals-page-menu">
    <!-- Main Menu Bar -->
    <nav class="menu-bar">
        <!-- Left Column with Menu Links -->
        <div class="menu-column left-column">
            <a href="/" class="menu-link">HOME</a>
            <a href="/buying" class="menu-link">BUYING</a>
            <a href="/resources" class="menu-link">RESOURCES</a>
            <a href="/contact" class="menu-link">CONTACT</a>
        </div>
        <!-- Right Column with Language Icon -->
        <div class="menu-column right-column">
            <a href="#" class="language-icon">
                <img src="https://dd-cdn.multiscreensite.com/flags/flags_iso/32/us.png" alt="Language Icon" />
            </a>
        </div>
    </nav>

    <!-- Hamburger Menu Icon -->
    <nav class="hamburger-menu" id="hamburger-menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </nav>

    <!-- Mobile Menu -->
    <nav class="mobile-menu" id="mobile-menu">
        <a href="/" class="menu-item">HOME</a>
        <a href="/buying" class="menu-item">BUYING</a>
        <a href="/resources" class="menu-item">RESOURCES</a>
        <a href="/contact" class="menu-item">CONTACT</a>
    </nav>
</div>

<!-- Image/Video Background Container -->
<div class="image-header-container">
    <!-- Video Background Section -->
    <div class="video-background-wrapper">
        <video autoplay="autoplay" playsinline="playsinline" muted="muted" loop="loop" class="video-background-frame"
        src="/static/icons/rentals1.mp4"></video>

        <!-- Overlay Content Section -->
        <div class="overlay-content">
            <div class="text-content">
                <h1 class="main-heading">SEE BELOW FOR ROOMS AND APARTMENTS!</h1>
            </div>
        </div>
    </div>
</div>

<!-- Leasing Qualifications Section -->
<div class="rental-services" id="rental-services">   
    <div class="rental-services-wrapper">    
        <div class="light-red-text">
            <h2>LEASING QUALIFICATIONS:</h2>
            <p>Rooms may require an application fee ranging from $30 to $60. These applications assist landlords in assessing and comparing their options. Minimum requirements may include a credit score of at least 550, two years of stable employment, and proof of income equivalent to approximately three times the monthly rent. Additionally, many rooms may necessitate a security deposit equal to the first month's rent, which can vary depending on whether the property is privately owned or managed. Rooms may be furnished.</p>
        </div>

        <div class="dark-red-text">
            <p>Note: If you do not meet these qualifications, the security deposit amount may be increased to facilitate approval.
            </p>
        </div>

        <!-- Call to Action Button -->
        <div class="navy-blue-text">
            <a href="/contact">
                <span class="text">Click here to request Availabilities!</span>
            </a>
        </div>
        
        <!-- Additional Information -->
        <div class="black-text">
           <p>A signed agreement is necessary to physically enter properties.</p>
            <p>We aim to show listings where the Landlords opt into covering a referral fee.</p>
            <p>Our fee is 25% of the first monthâ€™s rent. If covered, our services would come at no cost to you.</p>
        </div>
        
        <!-- Download Rental Representation Agreement -->
        <div class="light-green-text">
            <a href="/static/icons/NVARK1282.pdf">
                Download Rental Representation Agreement
            </a>
        </div>  
    </div>      
</div>


        
<!-- Automation -->
<div class="automation">
    <title>Dynamic Button Grid</title>
    <section id="dynamic-buttons" class="button-grid">
        <!-- Dynamic buttons will be inserted here -->
    </section>
</div><script>
    document.addEventListener('DOMContentLoaded', () => {
        const imageDirectory = '/static/icons/'; // Base directory for your images
        const numberOfListings = 5; // Number of listings you want to fetch

        // Fetch the listing data from the API with a limit
        fetch(`/api/listings?limit=${numberOfListings}`)
            .then(response => response.json())
            .then(data => {
                // `data` is an object with a "listings" property
                console.log(data);

                // Process each listing
                data.listings.forEach(item => {
                    createButtonDiv(item);
                });
            })
            .catch(error => console.error('Error fetching listings:', error));

        // Function to process and create buttons
        function createButtonDiv(data) {
            // Destructure the `data` object
            const { MLS, COST, ADDRESS, DESCRIPTION, STATUS, PHOTOS } = data;
            
            // Create a div element for the button
            const buttonDiv = document.createElement('div');
            buttonDiv.className = 'button-item';

            // Create a button element
            const button = document.createElement('button');
            button.style.padding = 0; // Ensure button has no extra padding
            button.style.border = 'none'; // Ensure button has no border
            button.style.background = 'none'; // Ensure button has no background

            // Create an img element (use a placeholder image or the first image from PHOTOS)
            const img = document.createElement('img');
            img.src = imageDirectory + (PHOTOS[0] || 'placeholder.jpg'); // Use the first image from the list or a placeholder
            img.alt = 'Button Image';

            // Create a div for text description
            const textDiv = document.createElement('div');
            textDiv.className = 'button-text';
            textDiv.innerHTML = `Cost: ${COST}<br>Address: ${ADDRESS}`;

            // Append the img and text to the button
            button.appendChild(img);
            button.appendChild(textDiv);

            // Set the button to open a popup on click
            button.onclick = (event) => {
                event.stopPropagation(); // Prevent click event from bubbling up
                showPopup(MLS, COST, ADDRESS, DESCRIPTION, STATUS, PHOTOS);
            };

            // Append the button to the div
            buttonDiv.appendChild(button);

            // Append the buttonDiv to the dynamic buttons section
            document.getElementById('dynamic-buttons').appendChild(buttonDiv);
        }

        function showPopup(MLS, COST, ADDRESS, DESCRIPTION, STATUS, PHOTOS) {
            // Create a popup
            const popup = document.createElement('div');
            popup.className = 'popup';

            // Create popup content
            const popupContent = document.createElement('div');
            popupContent.className = 'popup-content';

            // Add gallery images
            const popupGallery = document.createElement('div');
            popupGallery.className = 'popup-gallery';
            PHOTOS.forEach(photo => {
                const img = document.createElement('img');
                img.src = imageDirectory + photo;
                img.alt = 'Gallery Image';
                popupGallery.appendChild(img);
            });

            // Add text content
            const popupText = document.createElement('div');
            popupText.className = 'popup-text';
            popupText.innerHTML = `
                <h6>${COST} Monthly</h6>
                <p>${ADDRESS}</p>
                --------------------<br>
                <p>Description: ${DESCRIPTION}</p>
                --------------------<br>
                <p>${MLS}</p>
                <p>Status: ${STATUS}</p>
                <button class="contact-button" onclick="navigateToContact()">Click here to request more information</button><br><br>
            `;

            // Add close button
            const popupClose = document.createElement('span');
            popupClose.className = 'popup-close';
            popupClose.innerHTML = '&times;';
            popupClose.onclick = () => {
                closePopup(popup);
            };

            // Append elements to popup content
            popupContent.appendChild(popupGallery);
            popupContent.appendChild(popupText);
            popupContent.appendChild(popupClose);

            // Append popup content to popup
            popup.appendChild(popupContent);

            // Append popup to body
            document.body.appendChild(popup);

            // Add event listener to close the popup when clicking outside the content
            document.addEventListener('click', (event) => {
                if (event.target === popup) {
                    closePopup(popup);
                }
            });

            // Add event listener to close the popup when pressing the Esc key
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    closePopup(popup);
                }
            });
        }

        function closePopup(popup) {
            document.body.removeChild(popup);
        }
        
        // Ensure navigateToContact is globally accessible
        window.navigateToContact = () => {
            window.location.href = '/contact';
        };
    });
</script>







<!-- Custom Section with Parallax Effect -->
<div class="custom-section" id="main-section">
    <div class="custom-header">
        <h2 class="custom-heading">WE ARE HERE TO HELP</h2>
    </div>

    <div class="custom-container">
        <div class="custom-row">
            <div class="custom-column">
                <div class="custom-icon-widget">
                    <span class="custom-icon-homepage"></span>
                </div>
                <a class="custom-button-link" href="/">
                    <span class="button-text">HOME PAGE</span>
                </a>
            </div>

            <div class="custom-column">
                <div class="custom-icon-widget">
                    <span class="custom-icon-home"></span>
                </div>
                <a class="custom-button-link" href="/buying" id="button-search-homes">
                    <span class="button-text">SEARCH HOMES</span>
                </a>
            </div>

            <div class="custom-column">
                <div class="custom-icon-widget">
                    <span class="custom-icon-contact"></span>
                </div>
                <a class="custom-button-link" href="/contact">
                    <span class="button-text">LEAVE A MESSAGE</span>
                </a>
            </div>

            <div class="custom-column">
                <div class="custom-icon-widget">
                    <span class="custom-icon-head"></span>
                </div>
                <a class="custom-button-link" href="/resources">
                    <span class="button-text">FIND RESOURCES</span>
                </a>
            </div>
        </div>
    </div>
</div>


{% endblock %}
